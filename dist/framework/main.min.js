!function(e){"use strict";function n(e,n){if(!e&&null!==e)throw new Error("This argument can't be iterated",e);if("function"==typeof e)for(var t in e)"prototype"!==t&&n.call(null,e[t],t);else for(var t in e)n.call(null,e[t],t)}e.common=e.common||{};var t=e.common.functions=e.common.functions||{};t.array={},t.array.forEach=n}(window),function(){"use strict";function e(e,n){t(n,function(n,t){e[t]=n})}window.common=window.common||{};var n=window.common.functions=window.common.functions||{};n.object={},n.object.extend=e;var t=n.array.forEach}(),function(){"use strict";function e(e,n,t,o){var r=new XMLHttpRequest,i="?";for(var s in n)i+=s+"="+encodeURIComponent(n[s])+"&";i=i.substr(0,i.length-1),r.open("GET",e+i,!0),r.onreadystatechange=function(e){200==e.currentTarget.status?4==e.currentTarget.readyState&&void 0!==t&&t(e.currentTarget.response):4==e.currentTarget.readyState&&void 0!==o&&o(e.currentTarget.response)},r.send()}window.common=window.common||{};var n=window.common.xhr=window.common.xhr||{};n.get=e}(),function(){"use strict";function e(e,o){r[name]||i(e,{},n.bind(null,e,o),t),o(r[name])}function n(e,n,t){var o=document.createElement("div");o.innerHTML=t,n(r[name]=o.childNodes)}function t(){throw new Error("Template is not loaded, fuck your self.")}window.common=window.common||{};var o=window.common.templates=window.common.templates||{},r={},i=common.xhr.get;o.add=n,o.get=e}(),function(){"use strict";function e(e){if(!o[e])throw new Error("Model is not available: "+e);return o[e]}function n(e,n){o[e]&&console.warn("Reset model: "+e),o[e]=n}window.common=window.common||{};var t=window.common.models=window.common.models||{},o={};t.add=n,t.get=e}(),function(){function e(n){this.elem=e.find(n)}function n(e){this.elems=n.findAll(e)}function t(e){return this.elem.classList.contains(e)||this.elem.classList.add(e),this}function o(n){return new e(this.elem.querySelector(n))}function r(n){return new e(this.elem.querySelectorAll(n))}function i(e){return this.elem.value||console.warn("This element haven't value:",this.elem),this.elem.value}function s(e){return this.elem.value||console.warn("This element haven't value:",this.elem),this.elem.value=e,this}function c(e){var n=this.elem.getAttribute(e);return null===n&&console.warn("This element haven't attribute - "+e+":",this.elem),n}function a(e,n){return this.elem.setAttribute(e,n),this}function m(){return this.elem.innerHTML||console.warn("This element haven't html:",this.elem),this.elem.innerHTML}function l(e){return void 0===this.elem.innerHTML&&console.warn("This element haven't html:",this.elem),this.elem.innerHTML=e,this}function u(e){return this.elem.classList.contains(e)&&this.elem.classList.remove(e),this}function d(e,n){return this.elem.addEventListener?this.elem.addEventListener(e,n,!1):this.elem.attachEvent&&this.elem.attachEvent("on"+e,n),this}function w(e,n){return this.elem.removeEventListener?this.elem.removeEventListener(e,n,!1):this.elem.detachEvent&&this.elem.detachEvent("on"+e,n),this}window.common=window.common||{};var f=window.common.element=window.common.element||{};f.select=f.select||{},f.select.one=function(n){return new e(n)},f.select.list=function(e){return new n(e)},e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.searchIn=o,e.prototype.searchListIn=r,e.prototype.getValue=i,e.prototype.setValue=s,e.prototype.getHtml=m,e.prototype.setHtml=l,e.prototype.getAttribute=c,e.prototype.setAttribute=a,e.prototype.addClass=t,e.prototype.removeClass=u,e.prototype.addListener=d,e.prototype.removeListener=w,e.find=function(e){return e instanceof HTMLElement?e:document.querySelector(e)},n.findAll=function(e){return document.querySelectorAll(e)},n.prototype.addClass=function(e){for(var n=0;n<this.elems.length;n++)t.call({elem:this.elems[n]},e)},n.prototype.removeClass=function(e){for(var n=0;n<this.elems.length;n++)u.call({elem:this.elems[n]},e)}}(),function(){"use strict";function e(e){var e=n(e);return function(){return e}}common.models.add("element",e);var n=common.element.select.one}(),function(){"use strict";function e(e,n){return function(){return n}}common.models.add("parentComponent",e)}(),function(){"use strict";function e(e,n,r){var i=[];return o(e,function(e){"string"==typeof e?i.push(t(e)(n,r)):i.push(e)}),i}window.common=window.common||{};var n=window.common.DI=window.common.DI||{};n.get=e;var t=window.common.models.get,o=common.functions.array.forEach}(),function(){"use strict";function e(e){r(e,function(t,o){i.isFunction(t)||(e.__vars||Object.defineProperty(e,"__vars",{enumerable:!1,value:{},writable:!0}),Object.defineProperty(e.__vars,o,{enumerable:!1,value:{},writable:!0}),Object.defineProperty(e.__vars[o],"listeners",{enumerable:!1,value:[],writable:!0}),Object.defineProperty(e.__vars[o],"value",{enumerable:!1,value:t,writable:!0}),Object.defineProperty(e,o,{set:function(e){e!==this.__vars[o].value&&(this.__vars[o].value=e,n(this.__vars[o],e,o))},get:function(){return this.__vars[o].value}}))}),window.watchedObjects[s++]=e}function n(e,n,t){e.listeners&&r(e.listeners,function(e){e.__update(n,t)})}function t(e,n,t){e.__vars[t].listeners.push(n),n.__update(e[t])}window.common=window.common||{};var o=window.common.sync=window.common.sync={};o.setWatcher=e,o.appendListener=t;var r=common.functions.array.forEach,i=common.functions.types;window.common.observe.array;window.watchedObjects={};var s=0}(),function(){"use strict";function e(e){if(e=e.replace(/[A-Z]/g,function(e,n){return n?"-"+e.toLowerCase():e.toLowerCase()}),!r[e])throw new Error("Component is not available:"+e);return r[e]}function n(e,n){return e=e.replace(/[A-Z]/g,function(e,n){return n?"-"+e.toLowerCase():e.toLowerCase()}),r[e]?void console.warn("You try to reset component with name: "+e):(console.log(e),document.registerElement(e,{prototype:Object.create(HTMLDivElement.prototype,{attachedCallback:{value:function(){for(var n,o,c=this.parentNode,a=!1;c;){if(c.nodeName.toLowerCase()in r){a=!0;break}c=c.parentNode}n=r[e].inject?i.call(null,r[e].inject,this,a?c._component:void 0):[],n.unshift(null),o=new(Function.prototype.bind.apply(r[e],n)),o.onInit&&o.onInit(),Object.defineProperty(this,"_component",{enumerable:!1,value:o}),t(o,a?c._component:void 0),s(o)}}})}),void(r[e]=n))}function t(e,n){Object.defineProperty(e,"_childrens",{enumerable:!1,value:[]}),n&&Object.defineProperty(e,"_parent",{enumerable:!1,value:n}),n&&n._childrens.push(e)}window.common=window.common||{};var o=window.common.components=window.common.components||{},r={};o.add=n,o.get=e;var i=common.DI.get,s=common.sync.setWatcher}(),function(){"use strict";function e(e,n,t){if(n._parent)for(var o=n._parent;o;){if(o._listeners[e])for(var r=0;r<o._listeners[e].length;r++)o._listeners[e][r](t);o=o.parent}}function n(e,t,o){if(t._listeners&&t._listeners[e])for(var r=0;r<t._listeners[e].length;r++)t._listeners[e][r](o);if(t._childrens)for(var r=0;r<t._childrens.length;r++)n(e,t._childrens[r],o)}function t(e,n,t){n._listeners||Object.defineProperty(n,"_listeners",{enumerable:!1,value:{}}),n._listeners[e]||(n._listeners[e]=[]),n._listeners[e].push(t)}window.common=window.common||{};var o=window.common.events=window.common.events||{};o.emit=e,o.broadcast=n,o.on=t}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFycmF5LmpzIiwib2JqZWN0LmpzIiwieGhyLmpzIiwidGVtcGxhdGVTdG9yZS5qcyIsIm1vZGVsc1N0b3JlLmpzIiwiZWxlbWVudC5qcyIsInBhcmVudENvbXBvbmVudC5qcyIsIkRJLmpzIiwiZGF0YVN5bmMuanMiLCJjb21wb25lbnRzU3RvcmUuanMiLCJldmVudHMuanMiXSwibmFtZXMiOlsid2luZG93IiwiZm9yRWFjaCIsIm9iaiIsImZuIiwiRXJyb3IiLCJrIiwiY2FsbCIsImNvbW1vbiIsImZ1bmN0aW9ucyIsImFycmF5IiwiZXh0ZW5kIiwib2JqMSIsIm9iajIiLCJ2Iiwib2JqZWN0IiwiZ2V0IiwidXJsIiwiZGF0YSIsInJlc29sdmUiLCJyZWplY3QiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsInJlcXVlc3RCb2R5IiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwic3Vic3RyIiwibGVuZ3RoIiwib3BlbiIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsImUiLCJjdXJyZW50VGFyZ2V0Iiwic3RhdHVzIiwicmVhZHlTdGF0ZSIsInVuZGVmaW5lZCIsInJlc3BvbnNlIiwic2VuZCIsImNiIiwibG9hZGVkVGVtcGxhdGVzIiwibmFtZSIsImxvYWRUZW1wbGF0ZSIsImFkZCIsImJpbmQiLCJ0bXAiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJjaGlsZE5vZGVzIiwidGVtcGxhdGVzIiwiYXZhaWxhYmxlTW9kZWxzIiwiY29uc29sZSIsIndhcm4iLCJtb2RlbHMiLCJTZWxlY3RPbmUiLCJxdWVyeSIsInRoaXMiLCJlbGVtIiwiZmluZCIsIlNlbGVjdExpc3QiLCJlbGVtcyIsImZpbmRBbGwiLCJhZGRDbGFzcyIsImNsYXNzTmFtZSIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwic2VhcmNoSW4iLCJxdWVyeVNlbGVjdG9yIiwic2VhcmNoTGlzdEluIiwicXVlcnlTZWxlY3RvckFsbCIsImdldFZhbHVlIiwidmFsdWUiLCJzZXRWYWx1ZSIsImdldEF0dHJpYnV0ZSIsImF0dHIiLCJhdHRyVmFsIiwic2V0QXR0cmlidXRlIiwia2V5IiwiZ2V0SHRtbCIsInNldEh0bWwiLCJodG1sIiwicmVtb3ZlQ2xhc3MiLCJyZW1vdmUiLCJhZGRFdmVudExpc3RlbmVyIiwidHlwZSIsImF0dGFjaEV2ZW50IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImxpbmsiLCJkZXRhY2hFdmVudCIsImVsZW1lbnQiLCJzZWxlY3QiLCJvbmUiLCJsaXN0IiwicHJvdG90eXBlIiwiT2JqZWN0IiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJhZGRMaXN0ZW5lciIsInJlbW92ZUxpc3RlbmVyIiwiSFRNTEVsZW1lbnQiLCJpIiwicGFyZW50IiwicGFyZW50Q29tcG9uZW50IiwiZGVwZW5kZW5jaWVzIiwicmVzdWx0IiwiZGVwZW5kZW5jeU5hbWUiLCJwdXNoIiwiZ2V0TW9kZWwiLCJESSIsInNldFdhdGNoZXJzIiwidHlwaW5nIiwiaXNGdW5jdGlvbiIsIl9fdmFycyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsIndyaXRhYmxlIiwic2V0IiwidXBkYXRlTGlzdGVuZXJzIiwid2F0Y2hlZE9iamVjdHMiLCJvYmplY3RJZCIsImxpc3RlbmVycyIsIl9fdXBkYXRlIiwiYXBwZW5kTGlzdGVuZXIiLCJ2YWx1ZUZyb20iLCJ2aWV3Iiwic3luYyIsInNldFdhdGNoZXIiLCJ0eXBlcyIsIm9ic2VydmUiLCJyZXBsYWNlIiwidG9Mb3dlckNhc2UiLCJhdmFpbGFibGVDb21wb25lbnRzIiwibG9nIiwicmVnaXN0ZXJFbGVtZW50IiwiSFRNTERpdkVsZW1lbnQiLCJhdHRhY2hlZENhbGxiYWNrIiwiY29tcG9uZW50IiwicGFyZW50Tm9kZSIsImlzUGFyZW50Rm91bmQiLCJub2RlTmFtZSIsImluamVjdCIsIl9jb21wb25lbnQiLCJ1bnNoaWZ0IiwiRnVuY3Rpb24iLCJhcHBseSIsIm9uSW5pdCIsImJ1aWxkQ2hpbGRyZW5zQ2hhaW4iLCJhcHBlbmRXYXRjaGVycyIsIl9jaGlsZHJlbnMiLCJjb21wb25lbnRzIiwidXAiLCJfcGFyZW50IiwiX2xpc3RlbmVycyIsImEiLCJkb3duIiwib24iLCJldmVudHMiLCJlbWl0IiwiYnJvYWRjYXN0Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxHQUNBLFlBV0EsU0FBQUMsR0FBQUMsRUFBQUMsR0FDQSxJQUFBRCxHQUFBLE9BQUFBLEVBWUEsS0FBQSxJQUFBRSxPQUFBLGtDQUFBRixFQVhBLElBQUEsa0JBQUEsR0FDQSxJQUFBLEdBQUFHLEtBQUFILEdBQ0EsY0FBQUcsR0FBQUYsRUFBQUcsS0FBQSxLQUFBSixFQUFBRyxHQUFBQSxPQUlBLEtBQUEsR0FBQUEsS0FBQUgsR0FDQUMsRUFBQUcsS0FBQSxLQUFBSixFQUFBRyxHQUFBQSxHQWxCQUwsRUFBQU8sT0FBQVAsRUFBQU8sVUFDQSxJQUFBQyxHQUFBUixFQUFBTyxPQUFBQyxVQUFBUixFQUFBTyxPQUFBQyxhQUVBQSxHQUFBQyxTQUNBRCxFQUFBQyxNQUFBUixRQUFBQSxHQXNCQUQsUUM3QkEsV0FDQSxZQVVBLFNBQUFVLEdBQUFDLEVBQUFDLEdBQ0FYLEVBQUFXLEVBQUEsU0FBQUMsRUFBQVIsR0FDQU0sRUFBQU4sR0FBQVEsSUFWQWIsT0FBQU8sT0FBQVAsT0FBQU8sVUFDQSxJQUFBQyxHQUFBUixPQUFBTyxPQUFBQyxVQUFBUixPQUFBTyxPQUFBQyxhQUVBQSxHQUFBTSxVQUNBTixFQUFBTSxPQUFBSixPQUFBQSxDQUVBLElBQUFULEdBQUFPLEVBQUFDLE1BQUFSLFdDVEEsV0FDQSxZQWFBLFNBQUFjLEdBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBRUEsR0FBQUMsR0FBQSxHQUFBQyxnQkFDQUMsRUFBQSxHQUVBLEtBQUEsR0FBQWpCLEtBQUFZLEdBQ0FLLEdBQUFqQixFQUFBLElBQUFrQixtQkFBQU4sRUFBQVosSUFBQSxHQUdBaUIsR0FBQUEsRUFBQUUsT0FBQSxFQUFBRixFQUFBRyxPQUFBLEdBRUFMLEVBQUFNLEtBQUEsTUFBQVYsRUFBQU0sR0FBQSxHQUVBRixFQUFBTyxt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dkIsRUFBQUcsR0FDQSxHQUFBSCxFQUFBdUksWUFBQXZJLEVBQUF1SSxXQUFBaEgsR0FDQSxJQUFBLEdBQUE0RCxHQUFBLEVBQUFBLEVBQUFuRixFQUFBdUksV0FBQWhILEdBQUFaLE9BQUF3RSxJQUNBbkYsRUFBQXVJLFdBQUFoSCxHQUFBNEQsR0FBQWhGLEVBSUEsSUFBQUgsRUFBQW1JLFdBQ0EsSUFBQSxHQUFBaEQsR0FBQSxFQUFBQSxFQUFBbkYsRUFBQW1JLFdBQUF4SCxPQUFBd0UsSUFDQXNELEVBQUFsSCxFQUFBdkIsRUFBQW1JLFdBQUFoRCxHQUFBaEYsR0FLQSxRQUFBdUksR0FBQW5ILEVBQUF2QixFQUFBcUIsR0FDQXJCLEVBQUF1SSxZQUNBMUQsT0FBQW1CLGVBQUFoRyxFQUFBLGNBQ0FpRyxZQUFBLEVBQ0EzQyxXQUlBdEQsRUFBQXVJLFdBQUFoSCxLQUNBdkIsRUFBQXVJLFdBQUFoSCxPQUdBdkIsRUFBQXVJLFdBQUFoSCxHQUFBa0UsS0FBQXBFLEdBcEVBbkMsT0FBQU8sT0FBQVAsT0FBQU8sVUFDQSxJQUFBa0osR0FBQXpKLE9BQUFPLE9BQUFrSixPQUFBekosT0FBQU8sT0FBQWtKLFVBb0JBQSxHQUFBQyxLQUFBUCxFQUNBTSxFQUFBRSxVQUFBSixFQUNBRSxFQUFBRCxHQUFBQSIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIjsoZnVuY3Rpb24gKHdpbmRvdykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB3aW5kb3cuY29tbW9uID0gd2luZG93LmNvbW1vbiB8fCB7fTtcbiAgdmFyIGZ1bmN0aW9ucyA9IHdpbmRvdy5jb21tb24uZnVuY3Rpb25zID0gd2luZG93LmNvbW1vbi5mdW5jdGlvbnMgfHwge307XG5cbiAgZnVuY3Rpb25zLmFycmF5ID0ge307XG4gIGZ1bmN0aW9ucy5hcnJheS5mb3JFYWNoID0gZm9yRWFjaDtcbiAgLypBZGRpdGlvbmFsIGZ1bmN0aW9uIGZvciBpbnNpZGUgdXNlIG9yIHVzZSBpbiB1c2VycyBhcHBsaWNhdGlvblxuICAqIEluIEFkZGl0aW9uYWwgZnVuY3Rpb25zIHdpbGwgYmUgbW9zdCBjb21tb24gZnVuY3Rpb24sIGxpa2UgZm9yZWFjaCwgZXh0ZW5kLCByZWN1cnNpb24gZm9yRWFjaCwgZXRjLlxuICAqICovXG5cbiAgZnVuY3Rpb24gZm9yRWFjaChvYmosIGZuKSB7XG4gICAgaWYob2JqIHx8IG9iaiA9PT0gbnVsbCkge1xuICAgICAgaWYodHlwZW9mIChvYmopID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgZm9yICh2YXIgayBpbiBvYmopIHtcbiAgICAgICAgICBpZihrICE9PSAncHJvdG90eXBlJykgZm4uY2FsbChudWxsLCBvYmpba10sIGspO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgZm9yICh2YXIgayBpbiBvYmopIHtcbiAgICAgICAgICBmbi5jYWxsKG51bGwsIG9ialtrXSwgayk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIGFyZ3VtZW50IGNhblxcJ3QgYmUgaXRlcmF0ZWQnLCBvYmopO1xuICAgIH1cbiAgfVxuXG59KSh3aW5kb3cpOyIsIjsoZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgd2luZG93LmNvbW1vbiA9IHdpbmRvdy5jb21tb24gfHwge307XG4gICAgdmFyIGZ1bmN0aW9ucyA9IHdpbmRvdy5jb21tb24uZnVuY3Rpb25zID0gd2luZG93LmNvbW1vbi5mdW5jdGlvbnMgfHwge307XG5cbiAgICBmdW5jdGlvbnMub2JqZWN0ID0ge307XG4gICAgZnVuY3Rpb25zLm9iamVjdC5leHRlbmQgPSBleHRlbmQ7XG5cbiAgICB2YXIgZm9yRWFjaCA9IGZ1bmN0aW9ucy5hcnJheS5mb3JFYWNoO1xuXG4gICAgZnVuY3Rpb24gZXh0ZW5kKG9iajEsIG9iajIpIHtcbiAgICAgICAgZm9yRWFjaChvYmoyLCBmdW5jdGlvbiAodiwgaykge1xuICAgICAgICAgICAgb2JqMVtrXSA9IHY7XG4gICAgICAgIH0pO1xuICAgIH1cblxufSkoKTtcbiIsIjsoZnVuY3Rpb24gKCkge1xuICBcInVzZSBzdHJpY3RcIjtcbiAgd2luZG93LmNvbW1vbiA9IHdpbmRvdy5jb21tb24gfHwge307XG4gIHZhciB4aHIgPSB3aW5kb3cuY29tbW9uLnhociA9IHdpbmRvdy5jb21tb24ueGhyIHx8IHt9O1xuXG4gIC8qVGhpcyBpcyBBSkFYIHBhcnQgb2YgU1BBRnJhbWV3b3JrXG4gICogSGVyZSBpIHdpbGwgd3JpdGUgY29kZSBvbmx5IGZvciBBSkFYIHJlcXVlc3Qgd2hpY2ggaSB3aWxsIHVzZSBpbiBwcm9qZWN0IGFuZCB1c2VycyBwcm9qZWN0XG4gICpcbiAgKiBAcGFyYW1zICd1cmwnIC0gYWRkcmVzcyB0byByZXNvdXJjZSBmb3IgZ2V0IHJlcXVlc3Qgb3Igc2VuZCByZXNwb25zZVxuICAqIEBwYXJhbXMgJ2RhdGEnIC0gZGF0YSB3aGljaCB3aWxsIHNlbmQgdG8gdGhhdCByZXF1ZXN0XG4gICogQHBhcmFtcyByZXNvbHZlIGFuZCByZWplY3QgLSBjYWxsYmFja3Mgd2hpY2ggd2lsbCBjYWxsZWQgYnkgZGVwZW5kZW5jeSBvZiByZXNwb25zZSBmcm9tIHJlc291cmNlXG4gICogKi9cbiAgeGhyLmdldCA9IGdldDtcblxuICBmdW5jdGlvbiBnZXQodXJsLCBkYXRhLCByZXNvbHZlLCByZWplY3QpIHtcblxuICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICB2YXIgcmVxdWVzdEJvZHkgPSBcIj9cIjtcblxuICAgIGZvciAodmFyIGsgaW4gZGF0YSkge1xuICAgICAgcmVxdWVzdEJvZHkgKz0gayArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGRhdGFba10pICsgXCImXCI7XG4gICAgfVxuXG4gICAgcmVxdWVzdEJvZHkgPSByZXF1ZXN0Qm9keS5zdWJzdHIoMCwgcmVxdWVzdEJvZHkubGVuZ3RoIC0gMSk7XG5cbiAgICB4aHIub3BlbignR0VUJywgdXJsK3JlcXVlc3RCb2R5LCB0cnVlKTtcblxuICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYoZS5jdXJyZW50VGFyZ2V0LnN0YXR1cyA9PSAyMDApIHtcbiAgICAgICAgZS5jdXJyZW50VGFyZ2V0LnJlYWR5U3RhdGUgPT0gNCAmJiByZXNvbHZlICE9PSB1bmRlZmluZWQgJiYgcmVzb2x2ZShlLmN1cnJlbnRUYXJnZXQucmVzcG9uc2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZS5jdXJyZW50VGFyZ2V0LnJlYWR5U3RhdGUgPT0gNCAmJiByZWplY3QgIT09IHVuZGVmaW5lZCAmJiByZWplY3QoZS5jdXJyZW50VGFyZ2V0LnJlc3BvbnNlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgeGhyLnNlbmQoKTtcbiAgfVxufSkoKTsiLCI7KGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB3aW5kb3cuY29tbW9uID0gd2luZG93LmNvbW1vbiB8fCB7fTtcbiAgICB2YXIgdGVtcGxhdGVzID0gd2luZG93LmNvbW1vbi50ZW1wbGF0ZXMgPSB3aW5kb3cuY29tbW9uLnRlbXBsYXRlcyB8fCB7fTtcblxuICAgIC8qXG4gICAgICogVGVtcGxhdGUgc3RvcmUgLSB0aGlzIGlzIHRlbXBsYXRlIGxvYWRlciB3aGljaCB3aWxsIHVzZSB0byBsb2FkIHRlbXBsYXRlcyBvZiBjb21wb25lbnRcbiAgICAgKiBsb2FkZWRUZW1wbGF0ZXMgLSB0aGlzIGlzIGNhY2hlZCB0ZW1wbGF0ZXMgKEhUTUxFbGVtZW50cyksIHdpdGgga2V5IGxpa2UgdXJsIGFuZCBhbGwgdGltZSB0aGVuIGkgd2lsbCB0cnkgdG8gbG9hZCBzb21lXG4gICAgICogcmVzb3VyY2UgaSB3aWxsIGNoZWNrIGhpcyBpbiBsb2FkZWRUZW1wbGF0ZXMgb2JqZWN0LlxuICAgICAqIElmIHRlbXBsYXRlIHdhcyBsb2FkZWQgYmVmb3JlIC0gc28gcmV0dXJuIEhUTUxFbGVtZW50XG4gICAgICogZWxzZSAtIGxvYWQgaHRtbCBzdHJpbmc/IGNvbnZlcnQgdGhpcyB0byBIVE1MRWxlbWVudCwgYW5kIHNldCBpbiBjYWNoZVxuICAgICAqICovXG5cbiAgICB2YXIgbG9hZGVkVGVtcGxhdGVzID0ge307XG5cbiAgICAvKm5hbWVzcGFjZXMqL1xuXG4gICAgdmFyIGxvYWRUZW1wbGF0ZSA9IGNvbW1vbi54aHIuZ2V0O1xuICAgIHRlbXBsYXRlcy5hZGQgPSBhZGQ7XG4gICAgdGVtcGxhdGVzLmdldCA9IGdldDtcblxuICAgIGZ1bmN0aW9uIGdldCh1cmwsIGNiKSB7XG4gICAgICAgIGlmICghbG9hZGVkVGVtcGxhdGVzW25hbWVdKSB7XG4gICAgICAgICAgICBsb2FkVGVtcGxhdGUodXJsLCB7fSwgYWRkLmJpbmQobnVsbCwgdXJsLCBjYiksIHJlamVjdClcbiAgICAgICAgfVxuXG4gICAgICAgIGNiKGxvYWRlZFRlbXBsYXRlc1tuYW1lXSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkKHVybCwgY2IsIGRhdGEpIHtcbiAgICAgICAgdmFyIHRtcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gICAgICAgIHRtcC5pbm5lckhUTUwgPSBkYXRhO1xuXG4gICAgICAgIGNiKGxvYWRlZFRlbXBsYXRlc1tuYW1lXSA9IHRtcC5jaGlsZE5vZGVzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWplY3QoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGVtcGxhdGUgaXMgbm90IGxvYWRlZCwgZnVjayB5b3VyIHNlbGYuJyk7XG4gICAgfVxufSkoKTsiLCI7KGZ1bmN0aW9uICgpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgd2luZG93LmNvbW1vbiA9IHdpbmRvdy5jb21tb24gfHwge307XG4gIHZhciBtb2RlbHMgPSB3aW5kb3cuY29tbW9uLm1vZGVscyA9IHdpbmRvdy5jb21tb24ubW9kZWxzIHx8IHt9O1xuXG4gICAgLypcbiAgICAgKiBTdG9yZSBvZiBzZXJ2aWNlc1xuICAgICAqICovXG4gIHZhciBhdmFpbGFibGVNb2RlbHMgPSB7fTtcblxuICBtb2RlbHMuYWRkID0gYWRkO1xuICBtb2RlbHMuZ2V0ID0gZ2V0O1xuXG4gIGZ1bmN0aW9uIGdldChuYW1lKSB7XG4gICAgICBpZiAoIWF2YWlsYWJsZU1vZGVsc1tuYW1lXSkgdGhyb3cgbmV3IEVycm9yKFwiTW9kZWwgaXMgbm90IGF2YWlsYWJsZTogXCIgKyBuYW1lKTtcblxuICAgIHJldHVybiBhdmFpbGFibGVNb2RlbHNbbmFtZV07XG4gIH1cblxuICBmdW5jdGlvbiBhZGQobmFtZSwgZm4pIHtcbiAgICAgIGlmIChhdmFpbGFibGVNb2RlbHNbbmFtZV0pIGNvbnNvbGUud2FybihcIlJlc2V0IG1vZGVsOiBcIiArIG5hbWUpO1xuXG4gICAgYXZhaWxhYmxlTW9kZWxzW25hbWVdID0gZm47XG4gIH1cbn0pKCk7IiwiOyhmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBjb21tb24ubW9kZWxzLmFkZCgnZWxlbWVudCcsIGVsZW1lbnQpO1xuXG4gICAgdmFyIFNlbGVjdE9uZSA9IGNvbW1vbi5lbGVtZW50LnNlbGVjdC5vbmU7XG5cblxuICAgIC8qXG4gICAgICog0J/QvtGH0LXQvNGDINGC0LDQuiAtINCy0YHQtSDQv9GA0L7RgdGC0L4sINC90LAg0LTQsNC90L3Ri9C5INC80L7QvNC10L3RgiDQvNC+0Lkg0LrQvtC90YLRgNC+0LvQu9C10YAg0L3QsCDQtdC70LXQvNC10L3RgtC1INC90LUg0LfQvdCw0LXRgiDQvtCxINC10LvQtdC80LXQvdGC0LUoRE9NKSxcbiAgICAgKiDRjyDQstGL0L3Rg9C20LTQtdC9INCy0YvQt9GL0LLQsNGC0Ywg0Y3RgtGDINC30LDQstC40YHQuNC80L7RgdGC0Ywg0LIg0LzQvtC80LXQvdGCINC40L3QuNGG0LjQsNC70LjQt9Cw0YbQuNC4INC60L7QvdGC0YDQvtC70LvQtdGA0LBcbiAgICAgKiDQvdCwINC60L7QvNC/0L7QvdC10L3RgtC1ICjQvNC10YHRgtC+LCDQs9C00LUg0LzQvdC1INC/0L7QutCwINC40LfQstC10YHRgtC10L0g0Y3Qu9C10LzQtdC90YIpXG4gICAgICog0Lgg0LTQu9GPINGC0L7Qs9C+LCDRh9GC0L7QsdGLINC60L7QvdC10YfQvdC+0LzRgyDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y4g0LLRgdC1INC30LDQstC40YHQuNC80L7RgdGC0Lgg0LjRgdC/0L7Qu9GM0LfQvtCy0LDRgtGMINC+0LTQuNC90LDQutC+0LLQvlxuICAgICAqIC0g0Y8g0LLRi9C90YPQttC00LXQvSDQv9GA0LjQvdGP0YLRjCDRgtCw0LrQvtC1INGA0LXRiNC10L3QuNC1XG4gICAgICogKi9cbiAgICBmdW5jdGlvbiBlbGVtZW50KGVsZW0pIHtcbiAgICAgICAgdmFyIGVsZW0gPSBTZWxlY3RPbmUoZWxlbSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbTtcbiAgICAgICAgfTtcbiAgICB9XG5cbn0pKCk7IiwiOyhmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBjb21tb24ubW9kZWxzLmFkZCgncGFyZW50Q29tcG9uZW50JywgcGFyZW50KTtcblxuXG5cbiAgICAvKlxuICAgICAqINCf0L7Rh9C10LzRgyDRgtCw0LogLSDQstGB0LUg0L/RgNC+0YHRgtC+LCDQvdCwINC00LDQvdC90YvQuSDQvNC+0LzQtdC90YIg0LzQvtC5INC60L7QvdGC0YDQvtC70LvQtdGAINC90LAg0LXQu9C10LzQtdC90YLQtSDQvdC1INC30L3QsNC10YIg0L7QsSDQtdC70LXQvNC10L3RgtC1KERPTSksXG4gICAgICog0Y8g0LLRi9C90YPQttC00LXQvSDQstGL0LfRi9Cy0LDRgtGMINGN0YLRgyDQt9Cw0LLQuNGB0LjQvNC+0YHRgtGMINCyINC80L7QvNC10L3RgiDQuNC90LjRhtC40LDQu9C40LfQsNGG0LjQuCDQutC+0L3RgtGA0L7Qu9C70LXRgNCwXG4gICAgICog0L3QsCDQutC+0LzQv9C+0L3QtdC90YLQtSAo0LzQtdGB0YLQviwg0LPQtNC1INC80L3QtSDQv9C+0LrQsCDQuNC30LLQtdGB0YLQtdC9INGN0LvQtdC80LXQvdGCKVxuICAgICAqINC4INC00LvRjyDRgtC+0LPQviwg0YfRgtC+0LHRiyDQutC+0L3QtdGH0L3QvtC80YMg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GOINCy0YHQtSDQt9Cw0LLQuNGB0LjQvNC+0YHRgtC4INC40YHQv9C+0LvRjNC30L7QstCw0YLRjCDQvtC00LjQvdCw0LrQvtCy0L5cbiAgICAgKiAtINGPINCy0YvQvdGD0LbQtNC10L0g0L/RgNC40L3Rj9GC0Ywg0YLQsNC60L7QtSDRgNC10YjQtdC90LjQtVxuICAgICAqICovXG4gICAgZnVuY3Rpb24gcGFyZW50KGVsZW1lbnQsIHBhcmVudENvbXBvbmVudCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHBhcmVudENvbXBvbmVudDtcbiAgICAgICAgfTtcbiAgICB9XG5cbn0pKCk7IiwiOyhmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB3aW5kb3cuY29tbW9uID0gd2luZG93LmNvbW1vbiB8fCB7fTtcbiAgICB2YXIgREkgPSB3aW5kb3cuY29tbW9uLkRJID0gd2luZG93LmNvbW1vbi5ESSB8fCB7fTtcbiAgICBESS5nZXQgPSBnZXQ7XG5cbiAgICB2YXIgZ2V0TW9kZWwgPSB3aW5kb3cuY29tbW9uLm1vZGVscy5nZXQ7XG4gICAgdmFyIGZvckVhY2ggPSBjb21tb24uZnVuY3Rpb25zLmFycmF5LmZvckVhY2g7XG5cbiAgICBmdW5jdGlvbiBnZXQoZGVwZW5kZW5jaWVzLCBlbGVtZW50LCBwYXJlbnQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICBmb3JFYWNoKGRlcGVuZGVuY2llcywgZnVuY3Rpb24gKGRlcGVuZGVuY3lOYW1lKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGRlcGVuZGVuY3lOYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGdldE1vZGVsKGRlcGVuZGVuY3lOYW1lKShlbGVtZW50LCBwYXJlbnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGRlcGVuZGVuY3lOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbn0pKCk7IiwiOyhmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB3aW5kb3cuY29tbW9uID0gd2luZG93LmNvbW1vbiB8fCB7fTtcblxuICAgIHZhciBzeW5jID0gd2luZG93LmNvbW1vbi5zeW5jID0gd2luZG93LmNvbW1vbi5zeW5jID0ge307XG5cbiAgICBzeW5jLnNldFdhdGNoZXIgPSBzZXRXYXRjaGVycztcbiAgICBzeW5jLmFwcGVuZExpc3RlbmVyID0gYXBwZW5kTGlzdGVuZXI7XG5cbiAgICB2YXIgZm9yRWFjaCA9IGNvbW1vbi5mdW5jdGlvbnMuYXJyYXkuZm9yRWFjaDtcblxuICAgIHZhciB0eXBpbmcgPSBjb21tb24uZnVuY3Rpb25zLnR5cGVzO1xuXG4gICAgdmFyIGFycmF5T2JzZXJ2ZSA9IHdpbmRvdy5jb21tb24ub2JzZXJ2ZS5hcnJheTtcbiAgICAvKtCe0LHRitC10LrRgiDRgdC+INGB0L/QuNGB0LrQvtC8INCy0YHQtdGFINC90LDQsdC70Y7QtNCw0LXQvNGL0YUg0L/QtdGA0LXQvNC10L3QvdGL0YUuXG4gICAgICog0J/QvtGB0LvQtSDQuNC90LjRgtC40LDQu9C40LfQsNGG0LjQuCDQuNC80LXQtdGCINGB0LvQtdC00YPRjtGO0YnQuNC5INCy0LjQtDpcbiAgICAgKiB3YXRjaGVkT2JqZWN0czoge1xuICAgICAqICAgICAgMDoge1xuICAgICAqICAgICAgICAgICBfX3ZhcnM6IHtcbiAgICAgKiAgICAgICAgICAgICAgIGZpcnN0VmFyOiB7XG4gICAgICogICAgICAgICAgICAgICAgICAgdmFsdWU6IDEwLFxuICAgICAqICAgICAgICAgICAgICAgICAgIGxpc3RlbmVyczogW1xuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAvL9Ck0YPQvdC60YbQuNC4INC/0YDQvtGB0LvRg9GI0LXQuiwg0LrQvtGC0L7RgNGL0LUg0LHRg9C00YPRgiDQstGL0LfQstCw0L3RiyDQtNC70Y8g0L/QtdGA0LXQs9C10L3QtdGA0LDRhtC40LggaHRtbFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBvbmUobmV3VmFsdWUsIGtleSkge30sXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHR3byhuZXdWYWx1ZSwga2V5KSB7fVxuICAgICAqICAgICAgICAgICAgICAgICAgIF1cbiAgICAgKiAgICAgICAgICAgICAgIH1cbiAgICAgKiAgICAgICAgICB9XG4gICAgICogICAgICB9LFxuICAgICAqICAgICAgMToge1xuICAgICAqICAgICAgICAgICBfX3ZhcnM6IHtcbiAgICAgKiAgICAgICAgICAgICAgIGZpcnN0QXJyYXk6IHtcbiAgICAgKiAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXlNb2RpZnlDaGVja2VyWzEsIDIsIDMsIDRdLFxuICAgICAqICAgICAgICAgICAgICAgICAgIGxpc3RlbmVyczogW1xuICAgICAqICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBvbmUobmV3VmFsdWUsIGtleSkge30sXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHR3byhuZXdWYWx1ZSwga2V5KSB7fVxuICAgICAqICAgICAgICAgICAgICAgICAgIF1cbiAgICAgKiAgICAgICAgICAgICAgIH1cbiAgICAgKiAgICAgICAgICB9XG4gICAgICogICAgICB9XG4gICAgICogfVxuICAgICAqICovXG4gICAgdmFyIHdhdGNoZWRPYmplY3RzID0ge307XG5cbiAgICAvL1RPRE86IGN1dCB0aGlzIGFmdGVyIHRlc3RpbmdcbiAgICB3aW5kb3cud2F0Y2hlZE9iamVjdHMgPSB7fTtcblxuICAgIHZhciBvYmplY3RJZCA9IDA7XG5cbiAgICBmdW5jdGlvbiBzZXRXYXRjaGVycyhvYmplY3QpIHtcbiAgICAgICAgZm9yRWFjaChvYmplY3QsIGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICBpZiAoIXR5cGluZy5pc0Z1bmN0aW9uKHYpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFvYmplY3QuX192YXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmplY3QsICdfX3ZhcnMnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmplY3QuX192YXJzLCBrLCB7XG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZToge30sXG4gICAgICAgICAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqZWN0Ll9fdmFyc1trXSwgJ2xpc3RlbmVycycsIHtcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmplY3QuX192YXJzW2tdLCAndmFsdWUnLCB7XG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdixcbiAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iamVjdCwgaywge1xuICAgICAgICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodiAhPT0gdGhpcy5fX3ZhcnNba10udmFsdWUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX192YXJzW2tdLnZhbHVlID0gdjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVMaXN0ZW5lcnModGhpcy5fX3ZhcnNba10sIHYsIGspO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX192YXJzW2tdLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLyppZiAodHlwaW5nLmlzQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgYXJyYXlPYnNlcnZlKHVwZGF0ZUxpc3RlbmVycylcblxuICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG5cbiAgICAgICAgICAgICAgICAgfSovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgd2luZG93LndhdGNoZWRPYmplY3RzW29iamVjdElkKytdID0gb2JqZWN0O1xuICAgIH1cblxuICAgIC8qXG4gICAgICog0K3RgtC+INGE0YPQvdC60YbQuNGPINC+0LHQvdC+0LLQu9C10L3QuNGPINC/0L7QtNC/0LjRgdGH0LjQutC+0LIg0L3QsCDQv9C10YDQtdC80L3Rg9GOLiDQl9C00LXRgdGMINGPINCy0YvQt9GL0LLQsNGOINCy0YHQtSDRhNGD0L3QutGG0LjQuCDQv9GA0L7RgdC70YPRiNC10Log0Lgg0L/QtdGA0LXQtNCw0Y4g0LjQvCDQtNCy0LAg0L/QsNGA0LDQvNC10YLRgNCwXG4gICAgICog0J3QvtCy0L7QtSDQt9C90LDRh9C10L3QuNC1INC4INC40LzRjyDQutC70Y7Rh9CwLiDQkiDQv9GA0LjQvdGG0LjQv9C1INGPINCx0Ysg0YHQvNC+0LMg0YHQv9GA0LDQstC40YLRgdGPINGBINC+0LTQvdC40Lwg0LfQvdCw0YfQtdC90LjQtdC8LiDQndC+INC60LvRjtGHINC80L3QtSDQvdCw0LTQviDQtNC70Y8g0L/RgNC+0YHQu9GD0YjQtdC6LFxuICAgICAqINC60L7RgtC+0YDRi9C1INGB0LvQtdC00Y/RgiDQt9CwINGG0LXQu9GL0LzQuCDQvtCx0YrQtdC60YLQsNC80LguXG4gICAgICog0JzQvdC1INC90LXRgiDQvNGL0YHQu9CwINC00LvRjyDQutCw0LbQtNC+0Lkg0L/QtdGA0LXQvNC10L3QvdC+0Lkg0L7QsdGK0LXQutGC0LAg0YHQvtC30LTQsNCy0LDRgtGMINC+0YLQtNC10LvRjNC90YPRjiDRhNGD0L3QutGG0LjRjiDQvtCx0L3QvtCy0LvQtdC90LjRjy5cbiAgICAgKlxuICAgICAqINCvINGB0LXQudGH0LDRgSDQv9C+0LTRg9C80LDQuyDQviDRgtC+0LwsINGH0YLQviDQsiDRgdC70YPRh9Cw0LUg0YEg0L/RgNC+0YHQu9GD0YjQutC+0Lkg0LzQsNGB0YHQuNCy0LAgLSDRjyDQvdCw0YDRg9GI0YMg0YDQsNCx0L7RgtGDINC+0L/RgtC40LzQuNC30LDRgtC+0YDQsCwg0LrQvtGC0L7RgNGL0Lkg0L/QvtC/0YvRgtCw0LXRgtGB0Y8g0L7Qv9GC0LjQvNC40LfQuNGA0L7QstCw0YLRjFxuICAgICAqINC80LDRgdGB0LjQsi4g0JrQsNC6INCy0LDRgNC40LDQvdGCIC0g0L/RgNC40LnQtNC10YLRgdGPINC40YHQv9C+0LvRjNC30L7QstCw0YLRjCDQvdC+0LLRi9C5INC60LvQsNGB0YEg0L3QsNGB0LvQtdC00L3QuNC6INC+0YIg0LzQsNGB0YHQuNCy0LAuXG4gICAgICog0J3QviDRjyDQv9C+0LrQsCDQvdC10LfQvdCw0Y4uLi5cbiAgICAgKiAqL1xuXG4gICAgZnVuY3Rpb24gdXBkYXRlTGlzdGVuZXJzKG9iamVjdCwgdmFsdWUsIGtleSkge1xuICAgICAgICBpZiAob2JqZWN0Lmxpc3RlbmVycykge1xuICAgICAgICAgICAgZm9yRWFjaChvYmplY3QubGlzdGVuZXJzLCBmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgIHYuX191cGRhdGUodmFsdWUsIGtleSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFwcGVuZExpc3RlbmVyKHZhbHVlRnJvbSwgdmlldywga2V5KSB7XG4gICAgICAgIHZhbHVlRnJvbS5fX3ZhcnNba2V5XS5saXN0ZW5lcnMucHVzaCh2aWV3KTtcblxuICAgICAgICAvKtCS0YvQt9GL0LLQsNC10Lwg0L7QsdC90L7QstC70LXQvdC40LUg0LfQvdCw0YfQtdC90LjRjyDRgyDRgtC+0LvRjNC60L4t0YfRgtC+INC/0YDQuNCy0Y/Qt9Cw0L3QvtCz0L4g0Y3Qu9C10LzQtdC90YLQsCovXG4gICAgICAgIHZpZXcuX191cGRhdGUodmFsdWVGcm9tW2tleV0pO1xuICAgIH1cblxufSkoKTsiLCI7KGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHdpbmRvdy5jb21tb24gPSB3aW5kb3cuY29tbW9uIHx8IHt9O1xuICAgIHZhciBjb21wb25lbnRzID0gd2luZG93LmNvbW1vbi5jb21wb25lbnRzID0gd2luZG93LmNvbW1vbi5jb21wb25lbnRzIHx8IHt9O1xuICAgIC8qXG4gICAgICogQ29tcG9uZW50IHN0b3JlIC0gbW9zdCBpbXBvcnRhbnQgY2xhc3MsIEZhY3Rvcnkgb2YgY29tcG9uZW50LCB3aGljaCB3aWxsIHJldHVyblxuICAgICAqIGV4YW1wbGUgb2YgY29tcG9uZW50IGNsYXNzIHdpdGggYWRkaXRpb25hbCBmdW5jdGlvbnNcbiAgICAgKiAqL1xuICAgIHZhciBhdmFpbGFibGVDb21wb25lbnRzID0ge307XG4gICAgY29tcG9uZW50cy5hZGQgPSBhZGQ7XG4gICAgY29tcG9uZW50cy5nZXQgPSBnZXQ7XG5cbiAgICB2YXIgREkgPSBjb21tb24uREkuZ2V0O1xuICAgIHZhciBhcHBlbmRXYXRjaGVycyA9IGNvbW1vbi5zeW5jLnNldFdhdGNoZXI7XG5cbiAgICBmdW5jdGlvbiBnZXQobmFtZSkge1xuICAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bQS1aXS9nLCBmdW5jdGlvbiAodiwgaSkge1xuICAgICAgICAgICAgcmV0dXJuIGkgPyAnLScgKyB2LnRvTG93ZXJDYXNlKCkgOiB2LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghYXZhaWxhYmxlQ29tcG9uZW50c1tuYW1lXSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ29tcG9uZW50IGlzIG5vdCBhdmFpbGFibGU6XCIgKyBuYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhdmFpbGFibGVDb21wb25lbnRzW25hbWVdO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZChuYW1lLCBmbikge1xuXG4gICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tBLVpdL2csIGZ1bmN0aW9uICh2LCBpKSB7XG4gICAgICAgICAgICByZXR1cm4gaSA/ICctJyArIHYudG9Mb3dlckNhc2UoKSA6IHYudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGF2YWlsYWJsZUNvbXBvbmVudHNbbmFtZV0pIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIllvdSB0cnkgdG8gcmVzZXQgY29tcG9uZW50IHdpdGggbmFtZTogXCIgKyBuYW1lKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhuYW1lKTtcbiAgICAgICAgLypUT0RPOiBTZXQgcG9seWZpbGwqL1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqINCt0YLQviDQvNC10YXQsNC90LjQt9C8INC/0L4g0LTQvtCx0LDQstC70LXQvdC40Y4g0Log0Y3Qu9C10LzQtdC90YLQsNC8INC60L7QvdGB0YLRgNGD0LrRgtC+0YDQvtCyINC60L7QvNC/0L7QvdC10L3RgtC+0LJcbiAgICAgICAgICog0J3QsCDRgNC10LPQuNGB0YLRgNCw0YbQuNC4INGN0LvQtdC80LXQvdGC0LAgLSDQstGL0LfRi9Cy0LDQtdC8INC60L7QvdGB0YLRgNGD0LrRgtC+0YAg0LrQvtC80L/QvtC90LXQvdGC0LAsINGBINC+0L/QuNGB0LDQvdGL0LzQuCDQt9Cw0LLQuNGB0LjQvNC+0YHRgtGP0LzQuCDQsiDQuNC90LbQtdC60YLQvtGA0LVcbiAgICAgICAgICpcbiAgICAgICAgICog0J3RgyDQuCDQtNC+0LHQsNCy0LvRj9C10Lwg0YHQstGP0LfRjCDRgNC+0LTQuNGC0LXQu9GM0YHQutC40YUg0LrQvtC80L/QvtC90LXQvdGC0L7QsiDQuCDQstC70L7QttC10L3Ri9GFLlxuICAgICAgICAgKiDQndCwINC00LDQvdC90YvQuSDQvNC+0LzQtdC90YIgLSDRjyDQuNGB0L/QvtC70YzQt9GD0Y4g0Y3RgtGDINGB0LLRj9C30Ywg0LTQu9GPINGA0LDQsdC+0YLRiyDRgSDRgdC+0LHRi9GC0LjRj9C80LgsINC/0L4g0Y3RgtC+0Lkg0YbQtdC/0L7Rh9C60LUg0Y8g0LPQvtC90Y/RjiDRgdC+0LHRi9GC0LjRjy5cbiAgICAgICAgICog0J3QviDQsiDQv9GA0LjQvdGG0LjQv9C1LCDQstC+0LfQvNC+0LbQtdC9INCy0LDRgNC40LDQvdGCLCDRh9GC0L4g0Y8g0L3QsNGH0L3RgyDQuNGB0L/QvtC70YzQt9C+0LLQsNGC0Ywg0Y3RgtGDINGG0LXQv9C+0YfQutGDINC00LvRjyDQv9C10YDQtdC00LDRh9C4INC/0LDRgNCw0LzQtdGC0YDQvtCyINC80LXQttC00YNcbiAgICAgICAgICog0LrQvtC80L/QvtC90LXQvdGC0LDQvNC4Li4uXG4gICAgICAgICAqXG4gICAgICAgICAqINCd0L4g0Y8g0L/QvtC60LAg0YHQvtC80L3QtdCy0LDRjtGB0Ywg0LIg0Y3RgtC+0Lkg0LjQtNC10LUuLi4g0JzQvdC1INC90LUg0L3RgNCw0LLQuNGC0YHRjywg0YfRgtC+INGH0LDRgdGC0Ywg0YHQstGP0LfQuCDRjyDQvtGC0L/RgNCw0LLQu9GOINC6IGh0bWzQkSDQsCDQtNGA0YPQs9GD0Y4g0Log0LrQvtC00YMgSlNcbiAgICAgICAgICog0J3QsNC00L4g0L/QvtC00YPQvNCw0YLRjCDQviDQstCw0YDQuNCw0L3RgtC1INGBINGA0LDQsdC+0YLQvtC5INC40YHQutC70Y7Rh9C40YLQtdC70YzQvdC+IEpTLi4uXG4gICAgICAgICAqXG4gICAgICAgICAqINCc0L7QttC10YIg0Y3RgtC+INC70YPRh9GI0LDRjyDQuNC00LXRjywg0YfQtdC8INC00LDRjtGCINGB0L7QstGA0LXQvNC10L3QvdGL0LUg0L/QvtC00YXQvtC00YsuLi4g0JrQsNC6INCy0LDRgNC40LDQvSAtINC80L7QttC90L4g0LLQvtC+0LHRidC1INCy0YHRkSDQt9Cw0LLRj9C30LDRgtGMINC90LAg0YHQvtCx0YvRgtC40Y/RhVxuICAgICAgICAgKiDRgSDQvtC00L3QvtCz0L4g0LrQvtC80L/QvtC90LXQvdGC0LAg0L3QsCDQtNGA0YPQs9C40LUuLi5cbiAgICAgICAgICpcbiAgICAgICAgICogKi9cbiAgICAgICAgZG9jdW1lbnQucmVnaXN0ZXJFbGVtZW50KG5hbWUsIHtcbiAgICAgICAgICAgIHByb3RvdHlwZTogT2JqZWN0LmNyZWF0ZShIVE1MRGl2RWxlbWVudC5wcm90b3R5cGUsIHtcbiAgICAgICAgICAgICAgICBhdHRhY2hlZENhbGxiYWNrOiB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudE5vZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNQYXJlbnRGb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlcGVuZGVuY2llcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21wb25lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAocGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpIGluIGF2YWlsYWJsZUNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNQYXJlbnRGb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVwZW5kZW5jaWVzID0gYXZhaWxhYmxlQ29tcG9uZW50c1tuYW1lXS5pbmplY3QgPyBESS5jYWxsKG51bGwsIGF2YWlsYWJsZUNvbXBvbmVudHNbbmFtZV0uaW5qZWN0LCB0aGlzLCBpc1BhcmVudEZvdW5kID8gcGFyZW50Ll9jb21wb25lbnQgOiB1bmRlZmluZWQpIDogW107XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXBlbmRlbmNpZXMudW5zaGlmdChudWxsKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50ID0gbmV3IChGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5hcHBseShhdmFpbGFibGVDb21wb25lbnRzW25hbWVdLCBkZXBlbmRlbmNpZXMpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvbmVudC5vbkluaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQub25Jbml0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnX2NvbXBvbmVudCcsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY29tcG9uZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRDaGlsZHJlbnNDaGFpbihjb21wb25lbnQsIGlzUGFyZW50Rm91bmQgPyBwYXJlbnQuX2NvbXBvbmVudCA6IHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmRXYXRjaGVycyhjb21wb25lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYXZhaWxhYmxlQ29tcG9uZW50c1tuYW1lXSA9IGZuO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJ1aWxkQ2hpbGRyZW5zQ2hhaW4ob2JqZWN0LCBwYXJlbnQpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iamVjdCwgJ19jaGlsZHJlbnMnLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIHZhbHVlOiBbXVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqZWN0LCAnX3BhcmVudCcsIHtcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogcGFyZW50XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgaWYgKHBhcmVudCkgcGFyZW50Ll9jaGlsZHJlbnMucHVzaChvYmplY3QpO1xuICAgIH1cblxufSkoKTsiLCI7KGZ1bmN0aW9uICgpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgd2luZG93LmNvbW1vbiA9IHdpbmRvdy5jb21tb24gfHwge307XG4gIHZhciBldmVudHMgPSB3aW5kb3cuY29tbW9uLmV2ZW50cyA9IHdpbmRvdy5jb21tb24uZXZlbnRzIHx8IHt9O1xuXG4gIC8qIFRoaXMgaXMgZnVuY3Rpb24gd2hpY2ggaSB1c2UgdG8gc2VuZCBldmVudCBtZXNzYWdlXG4gICAqIFRoZXkgY3ljbGVkIGluIGN1cnJlbnQgb2JqZWN0IGFuZCB0cnkgdG8gZmluZCBvYmplY3QgbGlzdGVuZXJzIHdpdGggbWV0aG9kIHdoaWNoIHdlIHNldCBieSBwYXJhbXMgQG5hbWVcbiAgICogV2hlbiBjdXJyZW50IF9saXN0ZW5lcnMgb2JqZWN0IGlzIG92ZXJlZCwgdGhleSBhcmUgdHJ5IHRvIGZpbmQgbGlua3MgdG8gY2hpbGRyZW4gb3IgcGFyZW50LlxuICAgKiBBbmQgcmVwZWF0IGFsbCB3aG9zZSBmdW5jdGlvbnMgaW4gbmV4dCBvYmplY3RcbiAgICpcbiAgICogJ2Rvd24nIGZ1bmN0aW9uIC0gdHJ5IHRvIGZpbmQgY2hpbGRyZW5zIGluIGN1cnJlbnQgb2JqZWN0XG4gICAqICd1cCcgZnVuY3Rpb24gLSB0cnkgdG8gZmluZCBwYXJlbnQ7XG4gICAqXG4gICAqICdvbicgZnVuY3Rpb24gLSBhcHBlbmQgb2JqZWN0ICdfbGlzdGVuZXJzJyB0byBjdXJyZW50IG9iamVjdCBpZiB0aGV5IGlzIG5vdCBleGlzdFxuICAgKiBhbmQgcHVzaGVkIGNhbGxiYWNrIGluIHN0YWNrIG9mIGNhbGxiYWNrcy5cbiAgICpcbiAgICogQHBhcmFtcyBuYW1lIC0gbmFtZSBvZiBldmVudFxuICAgKiBAcGFyYW1zIG9iamVjdCAtIGN1cnJlbnQgb2JqZWN0IGZvciBmb3VuZCBvciBhcHBlbmQgZXZlbnRcbiAgICogQHBhcmFtcyBkYXRhIC0gd2hpY2ggd2lsbCBzZXQgYnkgYXJndW1lbnQgaW4gY2FsbGJhY2tcbiAgICpcbiAgICogVGhpcyBpcyBzaW1wbGUgRXZlbnRFbW1pdGVyXG4gICAqICovXG5cbiAgZXZlbnRzLmVtaXQgPSB1cDtcbiAgZXZlbnRzLmJyb2FkY2FzdCA9IGRvd247XG4gIGV2ZW50cy5vbiA9IG9uO1xuXG4gIGZ1bmN0aW9uIHVwKG5hbWUsIG9iamVjdCwgZGF0YSkge1xuICAgICAgaWYgKCFvYmplY3QuX3BhcmVudCkgcmV0dXJuO1xuXG4gICAgICB2YXIgcGFyZW50ID0gb2JqZWN0Ll9wYXJlbnQ7XG5cbiAgICB3aGlsZShwYXJlbnQpIHtcbiAgICAgIGlmKHBhcmVudC5fbGlzdGVuZXJzW25hbWVdKSB7XG4gICAgICAgIGZvcih2YXIgYSA9IDA7IGEgPCBwYXJlbnQuX2xpc3RlbmVyc1tuYW1lXS5sZW5ndGg7IGErKykge1xuICAgICAgICAgIHBhcmVudC5fbGlzdGVuZXJzW25hbWVdW2FdKGRhdGEpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnQ7XG4gICAgfVxuICB9XG5cblxuICBmdW5jdGlvbiBkb3duKG5hbWUsIG9iamVjdCwgZGF0YSkge1xuICAgIGlmKG9iamVjdC5fbGlzdGVuZXJzICYmIG9iamVjdC5fbGlzdGVuZXJzW25hbWVdKSB7XG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgb2JqZWN0Ll9saXN0ZW5lcnNbbmFtZV0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb2JqZWN0Ll9saXN0ZW5lcnNbbmFtZV1baV0oZGF0YSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYob2JqZWN0Ll9jaGlsZHJlbnMpIHtcbiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBvYmplY3QuX2NoaWxkcmVucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBkb3duKG5hbWUsIG9iamVjdC5fY2hpbGRyZW5zW2ldLCBkYXRhKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBvbihuYW1lLCBvYmplY3QsIGNiKSB7XG4gICAgaWYoIW9iamVjdC5fbGlzdGVuZXJzKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqZWN0LCAnX2xpc3RlbmVycycsIHtcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIHZhbHVlOiB7fVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYoIW9iamVjdC5fbGlzdGVuZXJzW25hbWVdKSB7XG4gICAgICBvYmplY3QuX2xpc3RlbmVyc1tuYW1lXSA9IFtdO1xuICAgIH1cblxuICAgIG9iamVjdC5fbGlzdGVuZXJzW25hbWVdLnB1c2goY2IpO1xuICB9XG5cbn0pKCk7Il19
